<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ã”ã»ã†ã³ï½œç¸„æ–‡ã‚¯ã‚¤ã‚º</title>
    <!--<link rel="stylesheet" href="../assets/css/style.css"/>
    <script defer src="../assets/js/state.js"></script>-->
    <base href="../">
    <link rel="stylesheet" href="assets/css/style.css" />
    <script defer src="assets/js/state.js"></script>
    <script defer>
        document.addEventListener('DOMContentLoaded', () => {
        const id = JomonQuiz.param('id');
        const art = JomonQuiz.getArtifact(id);
        if(!art){
        document.getElementById('content').innerHTML = '<p>æŒ‡å®šã•ã‚ŒãŸè³‡æ–™ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚<a href="index.html">å›³é‘‘ã¸æˆ»ã‚‹</a></p>';
        return;
        }
        document.getElementById('name').textContent = art.name;
        document.getElementById('explain').textContent = art.explanation || 'èª¬æ˜ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚';

        const solved = JomonQuiz.isSolved(id);
        JomonQuiz.qs('#pot').innerHTML = JomonQuiz.potIMG({src: art.imageUrl,solved,alt: art.name});

        function renderStars(count) {
        const max = 5;
        return 'â˜…'.repeat(count) + 'â˜†'.repeat(max - count);
        }

        if (art.rarity && art.rarity.stars === 5) {
        const badge = document.getElementById('legendBadge');
        badge.hidden = false;
        }


        if (art.rarity) {
        const box = document.getElementById('rarityBox');
        const starsEl = document.getElementById('rarityStars');
        const textEl = document.getElementById('rarityText');

        box.hidden = false;
        textEl.textContent = art.rarity.text || '';

        let current = 0;
        const target = art.rarity.stars;
        const interval = 400;

        const timer = setInterval(() => {
        current++;
        starsEl.textContent = renderStars(current);
        if (current >= target) clearInterval(timer);
        }, interval);
        }

        const footerOwner = document.getElementById('footerOwner');
        if (footerOwner && art.owner) {
        footerOwner.hidden = false;
        footerOwner.textContent = `éºç‰©:${art.owner}`;
        }

        const msg = document.getElementById('msg');
        if(solved){
        msg.innerHTML = `ãŠã‚ã§ã¨ã†ï¼ã‚·ãƒ«ã‚¨ãƒƒãƒˆã ã£ãŸ<strong>${art.name}</strong>ã«è‰²ãŒã¤ãã¾ã—ãŸã€‚`;
        }else{
        msg.innerHTML = 'ã¾ã ã‚¯ã‚¤ã‚ºã«æ­£è§£ã—ã¦ã„ã¾ã›ã‚“ã€‚<br/>ã‚¯ã‚¤ã‚ºã«æ­£è§£ã™ã‚‹ã¨è‰²ãŒã¤ãã¾ã™ã€‚';
        }

        document.getElementById('toQuiz').href = `pages/quiz.html?id=${art.id}`;
        document.getElementById('toExplain').href = `pages/explain.html?id=${art.id}`;
        document.getElementById('toIndex').href = `./index.html`;
        });
    </script>
</head>
<body>
    <div class="container" id="content">
        <header class="site">
            <h1 id="name">ã”ã»ã†ã³</h1>
            <!-- <a href="./index.html" class="badge">å›³é‘‘ã¸</a> -->
        </header>
        <div id="rarityBox" class="rarity-box" hidden>
            <div class="rarity-label">ãƒ¬ã‚¢åº¦</div>
            <div class="rarity-value" id="rarityStars">â˜†â˜†â˜†â˜†â˜†</div>
            <div class="rarity-text" id="rarityText"></div>
        </div>

        <div class="reward-box">
            <div id="pot" class="pot-wrap"></div>
            <div id="legendBadge" class="legendary-box" hidden>
                <div class="legendary-title">
                    ğŸº ä¼èª¬ã®éºç‰© ğŸº
                </div>
                <div class="legendary-stars">
                    â˜…â˜…â˜…â˜…â˜… Legendary â˜…â˜…â˜…â˜…â˜…
                </div>
                <div class="legendary-sub">
                    ç‰¹åˆ¥ãªä¾¡å€¤ã‚’æŒã¤éºç‰©ã‚’ç™ºè¦‹ã—ã¾ã—ãŸ
                </div>
            </div>

            <p id="msg" style="margin:8px 0 0 0"></p>
            <p id="explain" class="explain" style="margin-top:10px;"></p>
            <div class="actions" style="margin-top:10px">
                <a id="toIndex" class="button primary">å›³é‘‘ã¸æˆ»ã‚‹</a>
                <a id="toExplain" class="button">èª¬æ˜ã‚’è¦‹ã‚‹</a>
                <a id="toQuiz" class="button">ã‚¯ã‚¤ã‚ºã¸</a>
            </div>
        </div>
        <footer class="site-footer">
            <div class="footer-inner">
                <div id="footerOwner" class="footer-owner" hidden></div>
                <div class="footer-brand">kabosu brothers</div>
            </div>
        </footer>
    </div>
    <img class="character-sticker" src="assets/img/character.png" alt="ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼" />
</body>
</html>
